(()=>{"use strict";var t={n:e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return t.d(i,{a:i}),i},d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function o(t,e,i){return(e=n(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const s=window.jQuery;var r=t.n(s);let a,l,d;var h,c,u;"undefined"!=typeof yith_wcaf&&(a=null===(h=yith_wcaf)||void 0===h?void 0:h.ajax_url,l=null===(c=yith_wcaf)||void 0===c?void 0:c.nonces,d=null===(u=yith_wcaf)||void 0===u?void 0:u.labels);const f=r()(document),p=r()("body"),m=t=>{const{dashboard_url:e,endpoints:i}=yith_wcaf;return!!e&&(Object.keys(i).includes(t)?e.replace(/\/$/,"").concat("/",t,"/"):e)},g=t=>{var e;if(void 0===r().fn.selectWoo)return;null!==(e=t)&&void 0!==e&&e.length||(t=f);r()(".yith-wcaf-enhanced-select",t).not(".enhanced").each((function(){((t,e)=>{if(void 0===r().fn.selectWoo)return;const i=!!t.data("allow_clear"),n=t.data("placeholder"),o=t.data("minimum_input_length"),s=t.data("minimum_results_for_search"),l=t.data("action");let d={allowClear:i,placeholder:n,minimumInputLength:o||3,minimumResultsForSearch:s||0};!!l&&(d.ajax={url:a,dataType:"json",delay:250,data:e=>({term:e.term,action:l,security:t.data("security"),exclude:t.data("exclude"),include:t.data("include"),limit:t.data("limit")}),processResults(t){const e=[];return t&&r().each(t,(function(t,i){e.push({id:t,text:i})})),{results:e}},cache:!0}),d=r().extend(d,e||{});try{t.selectWoo(d).addClass("enhanced")}catch(t){}})(r()(this))}))},v=t=>{var e;null!==(e=t)&&void 0!==e&&e.length||(t=f);const i=r()(".yith-wcaf-toggle",t).not(".enhanced");i.length&&i.each((function(){(t=>{if(t.next(".toggle").length)return;const e=t.data("text-on"),i=t.data("text-off"),n=r()("<span/>",{class:"toggle","data-text-on":e||d.toggle_on,"data-text-off":i||d.toggle_off});t.after(n).addClass("enhanced")})(r()(this))}))},y=t=>{var e;null!==(e=t)&&void 0!==e&&e.length||(t=f);const i=r()(".yith-wcaf-accordion",t).not(".enhanced");i.length&&i.each((function(){(t=>{const e=r()(".accordion-radio",t);e.length&&(e.on("change",(function(){const i=e.filter(":checked").closest(".accordion-option").find(".accordion-content");r()(".accordion-content",t).not(i).slideUp(),i.slideDown()})).trigger("change"),t.addClass("enhanced"))})(r()(this))}))},w=t=>{var e;null!==(e=t)&&void 0!==e&&e.length||(t=f);const i=r()(".yith-wcaf-attach-file",t).not(".enhanced");i.length&&i.each((function(){(t=>{const e=t.parent().find('input[type="file"]');e.length&&(t.on("click",(function(t){t.preventDefault(),e.trigger("click")})).addClass("enhanced"),e.on("change",(function(e){const i=e.target.files,n=[];let o=t.next("small.files-list");for(const t in i)i.hasOwnProperty(t)&&n.push(i[t].name);if(n.length){if(o.length||(o=r()("<small/>",{class:"files-list"}),t.after(o)),o.text(n.join(", ")),t.hasClass("auto-submit")){const e=t.closest("form");if(!e.length)return;e.submit()}}else o.length&&o.remove()})))})(r()(this))}))},$=t=>{var e;if(void 0===r().fn.datepicker)return;null!==(e=t)&&void 0!==e&&e.length||(t=f);r()(".yith-wcaf-enhanced-date-picker",t).add(".date-picker-field",t).add(".date-picker",t).not(".enhanced").each((function(){(t=>{if(void 0===r().fn.datepicker)return;const e=t.data("format"),i=t.data("number-of-months"),n=t.data("max-date"),o=t.data("min-date"),s=t.data("altfield"),a=t.data("altformat"),l={dateFormat:e||"yy-mm-dd",numberOfMonths:i||1,maxDate:n||null,minDate:o||null,altField:s?t.next(s).get(0):null,altFormat:a||"",beforeShow(t,e){var i,n;null==e||null===(i=e.dpDiv)||void 0===i||null===(n=i.addClass("yith-wcaf-datepicker"))||void 0===n||n.addClass("yith-plugin-fw-datepicker-div")},onClose(t,e){var i,n,o;null==e||null===(i=e.dpDiv)||void 0===i||null===(n=i.hide())||void 0===n||null===(o=n.removeClass("yith-wcaf-datepicker"))||void 0===o||o.removeClass("yith-plugin-fw-datepicker-div")}};try{t.datepicker(l).addClass("enhanced")}catch(t){}})(r()(this))}))};class b{constructor(t){var e;o(this,"$container",void 0),o(this,"ERROR_CLASS","woocommerce-invalid"),this.$container=t,null!==(e=this.$container)&&void 0!==e&&e.length&&this.initValidation()}initValidation(){this.initForm(),this.initFields()}initForm(){const t=this.$container.is("form")?this.$container:this.$container.find("form");t.length&&t.on("submit yith_wcaf_validate_fields",(t=>{const e=r()(t.target);return!!this.validateForm(e)||(t.stopImmediatePropagation(),!1)}))}initFields(){const t=this.getFields(this.$container);t.length&&t.on("keyup change",(t=>{const e=r()(t.target);this.validateField(e)}))}getFieldWrapper(t){return t.closest(".form-row, .yith-plugin-fw-panel-wc-row")}getFields(t){return r()("input, select, textarea",t).not('input[type="submit"]').not(".select2-search__field")}getVisibleFields(t){return this.getFields(t).filter(((t,e)=>{const i=r()(e);return this.getFieldWrapper(i).is(":visible")}))}getInvalidVisibleFields(t){return this.getVisibleFields(t).filter(((t,e)=>{const i=this.getFieldWrapper(r()(e));return i.length&&i.is(`.${this.ERROR_CLASS}`)}))}isFieldValid(t){const e=this.getFieldWrapper(t),i=t.attr("type"),n=t.val();if(t.prop("required")||e.hasClass("required")||e.hasClass("validate-required")||e.hasClass("yith-plugin-fw--required")||["reg_username","reg_email","reg_password"].includes(t.get(0).id))if(e.hasClass("multi-check")&&"checkbox"===i){if(!this.getFields(e).filter(":checked").length)throw"missing"}else{if("checkbox"===i&&!t.is(":checked"))throw"missing";if(!n)throw"missing"}if(!n)return!0;const o=e.data("pattern");if(o){if(!new RegExp(o).test(n))throw"malformed"}const s=e.data("min_length")||t.data("min_length");if(s&&n.length<s)throw"short";const r=e.data("max_length")||t.data("max_length");if(r&&n.length>r)throw"long";if("number"===i){const e=parseFloat(t.attr("min")),i=parseFloat(t.attr("max")),o=parseFloat(n);if(e&&e>o||i&&i<o)throw"overflow"}const a=e.data("validation")||t.data("validation");if("url"===a&&!n.match(/^(https?:\/\/)?([\w.-]+)\.([a-z]{2,})(\/\S*)?$/i))throw"wrong_url";if("email"===a&&!n.match(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/))throw"wrong_email";return!0}validateField(t){let e=!1;try{e=this.isFieldValid(t)}catch(i){return this.reportError(t,i),e}finally{t.trigger("yith_wcaf_validated_field",[this,t,e])}return this.removeError(t),e}validateForm(t){const e=this.getVisibleFields(t);if(!e.length)return!0;let i=!0;e.each(((t,e)=>{const n=r()(e);this.validateField(n)||(i=!1)}));try{return!!i||(this.scrollToFirstError(t),!1)}finally{t.trigger("yith_wcaf_validated_form",[this,t,i])}}getErrorMsg(t,e){var i,n,o,s;let r;if("missing"===e){const e=this.getFieldWrapper(t),o=e.find("label");if(r=t.data("error")||e.data("error")||o.data("error"),r)return r;if(r="checkbox"===t.attr("type")?null==d||null===(i=d.errors)||void 0===i?void 0:i.accept_check:null==d||null===(n=d.errors)||void 0===n?void 0:n.compile_field,r)return r}return r=(null==d||null===(o=d.errors)||void 0===o?void 0:o[e])||(null==d||null===(s=d.errors)||void 0===s?void 0:s.general_error),r}reportError(t,e){const i=this.getFieldWrapper(t),n=this.getErrorMsg(t,e);if(i.addClass(this.ERROR_CLASS),!n)return;i.find(".error-msg").remove();const o=r()("<span/>",{class:"error-msg",text:n});i.append(o),this.maybeDisableSubmit(t)}removeError(t){const e=this.getFieldWrapper(t),i=e.find(".error-msg");e.removeClass(this.ERROR_CLASS),i.remove(),this.maybeEnableSubmit(t)}maybeDisableSubmit(t){const e=t.is("form")?t:t.closest("form"),i=this.getInvalidVisibleFields(e),n=e.find('.submit, [type="submit"]');n.length&&i.length&&n.addClass("disabled")}maybeEnableSubmit(t){const e=t.is("form")?t:t.closest("form"),i=this.getInvalidVisibleFields(e),n=e.find('.submit, [type="submit"]');n.length&&!i.length&&n.removeClass("disabled")}scrollToFirstError(t){const e=t.find(`.${this.ERROR_CLASS}`).first();if(!e.length)return;let i=this.findScrollableParent(t);i&&i.length||(i=r()("html, body"));const n=e.offset().top-i.offset().top;let o=n;i.is("html, body")||(o=i.get(0).scrollTop+n),i.animate({scrollTop:o})}findScrollableParent(t){let e,i,n=t.get(0);if(!n)return null;do{if(document===n)return null;e=window.getComputedStyle(n).overflowY,i="visible"!==e&&"hidden"!==e}while(!(i&&n.scrollHeight>n.clientHeight)&&(n=n.parentNode));return r()(n)}}class _{constructor(t){var e,i;o(this,"$container",void 0),o(this,"$fields",void 0),o(this,"dependencies",{}),this.$container=t,null!==(e=this.$container)&&void 0!==e&&e.length&&(this.initFields(),null!==(i=this.$fields)&&void 0!==i&&i.length&&this.initDependencies())}initFields(){this.$fields=this.$container.find(":input")}initDependencies(){this.buildDependenciesTree(),Object.keys(this.dependencies).length&&this.handleDependencies()}buildDependenciesTree(){this.$fields.closest("[data-dependencies]").each(((t,e)=>{const i=r()(e),n=i.attr("id");if(!n)return;const o={[n]:i.data("dependencies")};this.dependencies=r().extend(this.dependencies,o)})),this.$container.find("[data-dep-target]").each(((t,e)=>{const i=r()(e),n=i.data("dep-id"),o=i.data("dep-target"),s=i.data("dep-value");if(!n||!o||!s)return;const a={[o]:{[n]:s.toString().split(",")}};this.dependencies=r().extend(this.dependencies,a)}))}handleDependencies(){this.$fields.on("change",this.applyDependencies.bind(this)),this.applyDependencies()}applyDependencies(){r().each(this.dependencies,((t,e)=>{const i=this.findFieldContainer(t);if(!i.length)return;this.checkConditions(e)?null==i||i.fadeIn():null==i||i.hide()})),this.$container.trigger("yith_wcaf_dependencies_applied",[this])}findField(t){let e=this.$container.find(`#${t}`);return e.length||(e=this.$container.find(`#${t}_field`)),!!e.length&&(e.is(":input")||(e=e.find(":input")),e)}findFieldContainer(t){const e=this.findField(t);if(null==e||!e.length)return!1;let i=e.closest(`#${t}_container`);return i.length||(i=e.closest(".form-row")),i.length||(i=e.closest(".yith-plugin-fw__panel__option")),!!i.length&&i}checkConditions(t){let e=!0;return r().each(t,((t,i)=>{const n=this.findField(t);let o;if(e&&null!=n&&n.length){var s,r,a;if(n.first().is('input[type="radio"]'))o=null===(s=n.filter(":checked"))||void 0===s||null===(r=s.val())||void 0===r?void 0:r.toString();else o=null==n||null===(a=n.val())||void 0===a?void 0:a.toString();e=Array.isArray(i)?i.includes(o):"function"==typeof i?i(o):0===i.indexOf(":")?n.is(i):0===i.indexOf("!:")?!n.is(i.toString().substring(1)):0===i.indexOf("!")?i.toString().substring(1)!==o:i.toString()===o,void 0!==this.dependencies[t]&&(e=e&&this.checkConditions(this.dependencies[t]))}})),e}}const C=t=>{var e;null!==(e=t)&&void 0!==e&&e.length||(t=f),v(t),$(t),y(t),g(t),w(t),(()=>{const e=r()('input[type="password"]',t);e.length&&e.each((function(){const t=r()(this);if(t.hasClass("enhanced"))return;const e=r()("<div/>",{class:"password-wrapper"}),i=r()("<a/>",{class:"toggle-button click-to-show",role:"button",href:"",html:'<?xml version="1.0" encoding="UTF-8"?>\n<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs>\n        <rect id="path-1" x="0" y="0" width="24" height="24"></rect>\n    </defs>\n    <g id="Symbols" stroke="none" stroke-width="1">\n        <g id="edit-/-show">\n            <mask id="mask-2" fill="white">\n                <use xlink:href="#path-1"></use>\n            </mask>\n            <g id="edit-/-show-(Background/Mask)"></g>\n            <path d="M9,12 C9,13.642 10.358,15 12,15 C13.641,15 15,13.642 15,12 C15,10.359 13.641,9 12,9 C10.358,9 9,10.359 9,12 Z M2.10543073,11.684 L2,12 L2.10443617,12.316 C2.12631801,12.383 4.40799665,19 12,19 C19.5920014,19 21.8736803,12.383 21.8945675,12.316 L22,12 L21.8955631,11.684 C21.8736813,11.617 19.5920014,5 12,5 C4.40799665,5 2.12631794,11.617 2.10543073,11.684 Z M4.11657,12 C4.617863,10.842 6.68072367,7 12,7 C17.322258,7 19.3841249,10.846 19.8834286,12 C19.3821356,13.158 17.3192744,17 12,17 C6.6777401,17 4.61587369,13.154 4.11657,12 Z" fill="#000" mask="url(#mask-2)"></path>\n        </g>\n    </g>\n</svg>',title:(null==d?void 0:d.show_password_text)||"Show/Hide password"});t.wrap(e),t.after(i),i.on("click",(function(e){const n="password"===t.attr("type"),o=n?"text":"password",s=n?"click-to-hide":"click-to-show";e.preventDefault(),t.attr("type",o),i.removeClass("click-to-show click-to-hide").addClass(s)})),t.addClass("enhanced")}))})(),(()=>{const e=r()("#invoice_type_field",t);if(!e.length||e.hasClass("enhanced"))return;let i=1;e.addClass("enhanced").find("label").each((function(){const t=r()(this),e=t.prev(),n=`col${i}`;t.add(e).wrapAll(`<div class="${n}">`),i++}))})(),(()=>{const e=r()("form",t);if(!e.length)return!1;!function(t){var e;null!==(e=t)&&void 0!==e&&e.length||(t=f),new b(t)}(e),function(t){var e;null!==(e=t)&&void 0!==e&&e.length||(t=f),new _(t)}(e)})(),f.trigger("yith_wcaf_init_fields")},k=function(t,e,i,n,o){const s=r()(this);n instanceof FormData?(n.append("action",`yith_wcaf_${e}`),n.append("security",null!=l&&l[i]?null==l?void 0:l[i]:i)):n={action:`yith_wcaf_${e}`,security:null!=l&&l[i]?null==l?void 0:l[i]:i,...n};const d={url:a,data:n,method:t,beforeSend:()=>s.length&&(t=>{if(void 0===r().fn.block)return!1;try{return t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t}catch(t){return!1}})(s),complete:()=>s.length&&(t=>{if(void 0===r().fn.unblock)return!1;try{t.unblock()}catch(t){return!1}})(s),...o};return r().ajax(d)},S={request:k,get:function(...t){return k.call(this,"get",...t)},post:function(...t){return k.call(this,"post",...t)}};class x{constructor(t,e){o(this,"$trigger",void 0),o(this,"$initiator",void 0),o(this,"target",void 0),t.length&&(this.$trigger=t,this.target=e,this.init())}init(){this.$trigger.off("click").on("click",this.onClick.bind(this))}onClick(t){t.preventDefault(),this.$initiator=r()(t.target),this.copyContent(t)&&this.outputNotification()}copyContent(t){const e=this.target;let i;return i="function"==typeof e?e(this.$trigger,t):e,!!i.length&&(i.is("input")?this.copyInputContent(i):this.copyAnyContent(i),!0)}copyInputContent(t){var e;if(window.isSecureContext&&null!==(e=navigator)&&void 0!==e&&e.clipboard)return navigator.clipboard.writeText(t.val());this.selectContent(t),document.execCommand("copy")}copyAnyContent(t){var e;if(window.isSecureContext&&null!==(e=navigator)&&void 0!==e&&e.clipboard)return navigator.clipboard.writeText(t.text());const i=r()("<input/>",{val:t.text(),type:"text"});p.append(i),this.selectContent(i),document.execCommand("copy"),i.remove()}selectContent(t){this.isIos()?t.get(0).setSelectionRange(0,9999):t.select()}outputNotification(){if(!f.triggerHandler("yith_wcaf_hide_link_copied_alert")&&null!=d&&d.link_copied_message){const t=r()("<span/>",{class:"copy-confirmation",text:d.link_copied_message});t.prependTo(this.$initiator).fadeIn(300,(()=>{setTimeout((()=>{t.fadeOut(300,(()=>{t.remove()}))}),1e3)}))}}isIos(){return navigator.userAgent.match(/ipad|iphone/i)}}class F{constructor(t){o(this,"$container",void 0),o(this,"$source",void 0),o(this,"$username",void 0),o(this,"$destination",void 0),o(this,"token",void 0),o(this,"token_var",void 0),o(this,"affiliate",void 0),o(this,"timeout",void 0),o(this,"timeoutInterval",500),null!=t&&t.length&&(this.$container=t,this.token=this.$container.data("token"),this.token_var=this.$container.data("token-var"),this.affiliate=this.$container.data("affiliate"),this.init())}init(){this.$source=r()(".origin-url",this.$container),this.$destination=r()(".generated-url",this.$container),this.$username=r()(".username",this.$container),this.$source.length&&this.$destination.length&&(this.initActions(),this.initCopyButton())}initActions(){this.$source.on("change keyup",this.onChange.bind(this)).trigger("change")}initCopyButton(){this.$container.find(".copy-trigger").each((function(){const t=r()(this),e=t.parent().find(".copy-target");e.length&&new x(t,e)}))}onChange(){this.timeout&&clearTimeout(this.timeout),this.$source.val()&&(this.timeout=setTimeout(this.updateUrl.bind(this),this.timeoutInterval))}async updateUrl(){const t=this.$source.val();let e;if(this.token_var&&this.token)e=this.calculateUrl(t,this.token_var,this.token);else{const i=this.$username.val(),n=this.affiliate;e=await this.requestUrl(t,i,n)}this.$destination.val(e)}calculateUrl(t,e,i){let n;try{if(n=new URL(t),n.origin!==window.location.origin)return"";n.searchParams.set(e,i)}catch(t){return""}return n.toString()}requestUrl(t,e,i){return new Promise((n=>{S.get.call(this.$container,"get_referral_url","get_referral_url",{base:t,user:e,affiliate_id:i}).done((t=>{let e;var i;null!=t&&t.success?e=null==t||null===(i=t.data)||void 0===i?void 0:i.url:e="";n(e)})).fail((()=>n("")))}))}}class T{constructor(t){o(this,"$container",void 0),o(this,"$opener",void 0),o(this,"$form",void 0),o(this,"$token",void 0),null!=t&&t.length&&(this.$container=t,this.$opener=this.$container.find(".show-referrer-form"),this.$form=this.$container.find("form.referrer-form"),this.$token=this.$form.find('input[name="referrer_code"]'),this.init())}init(){this.$opener.on("click",this.onToggle.bind(this)),this.$form.on("submit",this.onSubmit.bind(this))}onToggle(t){t.preventDefault(),this.toggleForm()}onSubmit(t){t.preventDefault();const e=this.$token.val();if(!e)return!1;this.$form.addClass("processing"),this.setReferrer(e).done((t=>{this.$form.removeClass("processing"),this.afterSubmit(t)}))}afterSubmit(t){var e,i;(this.$container.find(".woocommerce-error, .woocommerce-message").remove(),null!=t&&null!==(e=t.data)&&void 0!==e&&e.template)&&this.$form.before(null==t||null===(i=t.data)||void 0===i?void 0:i.template);null!=t&&t.success&&(this.$form.slideUp(),this.$token.prop("disabled",!0),f.trigger("yith_wcaf_referrer_set"))}toggleForm(){this.$form.slideToggle()}setReferrer(t){return S.post.call(this.$container,"set_referrer","set_referrer",{referrer:t})}}class O{constructor(t){o(this,"$opener",void 0),o(this,"$tooltip",void 0),t.length&&t.data("tip")&&(this.$opener=t.first(),this.init())}init(){this.$opener.on("mouseenter",(()=>this.onMouseEnter())).on("mouseleave",(()=>this.onMouseLeave()))}hasTooltip(){return this.$opener.find(".tooltip").length}onMouseEnter(){this.hasTooltip()||this.attachTooltip(),this.showTooltip()}onMouseLeave(){this.hideTooltip()}attachTooltip(){if(this.hasTooltip())return;const t=this.maybeBuildTooltip();this.$opener.append(t)}detachTooltip(){var t;null!==(t=this.$tooltip)&&void 0!==t&&t.length&&this.$tooltip.detach()}showTooltip(){var t;if(null!==(t=this.$tooltip)&&void 0!==t&&t.length)return this.$tooltip.show().stop().animate({opacity:1},{duration:200})}hideTooltip(){var t;if(null!==(t=this.$tooltip)&&void 0!==t&&t.length)return this.$tooltip.stop().animate({opacity:0},{duration:200,complete:()=>{this.$tooltip.hide(),this.detachTooltip()}})}maybeBuildTooltip(){var t;if(null===(t=this.$tooltip)||void 0===t||!t.length){const t=this.$opener.data("tip");this.$tooltip=r()("<span/>",{html:t,class:"tooltip"})}return this.$tooltip}}class D{constructor(t,e){o(this,"$opener",null),o(this,"$target",null),o(this,"$modal",null),o(this,"$content",null),null!=t&&t.length&&(this.$opener=t,this.args=r().extend({title:!1,shouldOpen:!1,template:!1,onOpen:!1,onClose:!1},e||{}),this.init())}init(){this.$opener.on("click",(t=>{this.$target=r()(t.target),this.shouldOpen()&&(t.preventDefault(),this.onOpen())}))}shouldOpen(){var t;return"function"!=typeof(null===(t=this.args)||void 0===t?void 0:t.shouldOpen)||this.args.shouldOpen.call(this)}onOpen(){var t,e;let i=(null===(t=this.args)||void 0===t?void 0:t.template)||"",n=null;if("function"==typeof i&&(i=i.call(this)),null===(e=this.$content)||void 0===e||!e.length){var o;if(!i)return;"string"==typeof i?n=r()(i).detach():"function"==typeof i?n=i().detach():null!==(o=i)&&void 0!==o&&o.lenght&&(n=i.detach()),this.$content=n}this.maybeOpenModal(this.$content)}onClose(){this.maybeCloseModal()}maybeBuildModal(){var t,e;if(null!==(t=this.$modal)&&void 0!==t&&t.length)return this.$modal;const i=r()("<div/>",{class:"yith-wcaf-modal"}),n=r()("<div/>",{class:"content pretty-scrollbar"}),o=r()("<a/>",{class:"close-button main-close-button",html:"&times;",role:"button",href:"#"});if(this.$modal=i,i.append(n).append(o),null!==(e=this.args)&&void 0!==e&&e.title){const t=r()("<div/>",{class:"title",html:`<h3>${this.args.title}</h3>`});i.prepend(t)}return i.on("click",".close-button",(t=>{t.preventDefault(),this.onClose()})),this.$target.closest(".yith-wcaf-section").append(i),this.$modal}maybeDestroyModal(){var t;null!==(t=this.$modal)&&void 0!==t&&t.length&&this.$modal.remove()}maybeOpenModal(t){var e;null!==(e=this.$modal)&&void 0!==e&&e.length||this.maybeBuildModal(),this.$modal.hasClass("open")||(this.$modal.find(".content").append(t).end().fadeIn((()=>{var t,e;(this.$modal.addClass("open"),"function"==typeof(null===(t=this.args)||void 0===t?void 0:t.onOpen))&&(null===(e=this.args)||void 0===e||e.onOpen.call(this))})),p.addClass("yith-wcaf-open-modal"))}maybeCloseModal(){var t;null!==(t=this.$modal)&&void 0!==t&&t.length||this.maybeBuildModal(),this.$modal.hasClass("open")&&this.$modal.fadeOut((()=>{var t,e;(this.$modal.removeClass("open"),p.removeClass("yith-wcaf-open-modal"),"function"==typeof(null===(t=this.args)||void 0===t?void 0:t.onClose))&&(null===(e=this.args)||void 0===e||e.onClose.call(this))}))}}class M extends D{constructor(t,e){super(t,e=r().extend({beforeSubmit:!1,afterSubmit:!1,onFormInit:!1,redirectTo:window.location},e||{})),o(this,"$form",null)}maybeOpenModal(t){super.maybeOpenModal(t),this.$modal.promise().done(this.maybeInitForm.bind(this))}maybeInitForm(){var t,e;if(null!==(t=this.$form)&&void 0!==t&&t.length)return;const i=this.$modal.find("form");var n;i.length&&(C(i),i.on("submit",this.maybeSubmitForm.bind(this)),this.$form=i,"function"==typeof(null===(e=this.args)||void 0===e?void 0:e.onFormInit)&&(null===(n=this.args)||void 0===n||n.onFormInit.call(this)))}async maybeSubmitForm(t){var e;t.preventDefault(),"function"==typeof(null===(e=this.args)||void 0===e?void 0:e.beforeSubmit)&&this.args.beforeSubmit.call(this);try{const t=await this.ajaxSubmit();this.afterSubmit(t)}catch(t){return void this.reportError(t)}setTimeout((()=>{this.maybeCloseModal(),window.location=this.args.redirectTo}),3e3)}afterSubmit(t){var e;"function"==typeof(null===(e=this.args)||void 0===e?void 0:e.afterSubmit)&&this.args.afterSubmit.call(this,t)}reportError(t){const e=this.$form.find(".errors");e.length?e.text(t):this.$form.prepend(r()("<p/>",{class:"errors woocommerce-error",text:t})),this.$form.closest(".content").animate({scrollTop:0})}hideErrors(){this.$form.find(".errors").remove()}ajaxSubmit(){const t=this.$form.data("action"),e=this.$form.data("security");return new Promise(((i,n)=>{t&&e||n(""),this.hideErrors(),S.post.call(this.$modal,t,e,new FormData(this.$form.get(0)),{processData:!1,contentType:!1}).done((t=>{var e;null!=t&&t.success?i(null==t?void 0:t.data):n(null==t||null===(e=t.data)||void 0===e?void 0:e.message)})).fail((()=>n("")))}))}}class R extends M{constructor(t,e){super(t,e={template:"#withdraw_modal",title:null==d?void 0:d.withdraw_modal_title,redirectTo:m("payments"),...e||{}})}maybeInitForm(){super.maybeInitForm(),this.initAmountNotesHighlight()}initAmountNotesHighlight(){const t=this.$form.find(".min-withdraw-note"),e=this.$form.find(".max-withdraw-note");this.$form.on("change keyup",(i=>{const n=r()(i.target);if(!n.is(".amount"))return;const o=parseFloat(n.val()),s=parseFloat(n.attr("min")),a=parseFloat(n.attr("max"));o<s?(t.addClass("error"),e.removeClass("error")):o>a?(t.removeClass("error"),e.addClass("error")):(t.removeClass("error"),e.removeClass("error"))}))}afterSubmit(t){super.afterSubmit(t),null!=t&&t.template?this.afterSuccess(t.template):this.maybeCloseModal()}afterSuccess(t){const e=this.$modal.find(".content");this.$modal.find(".title").fadeOut(),e.fadeOut((()=>{e.empty().html(t).fadeIn()}))}}class E{constructor(t){o(this,"$container",void 0),t.length&&(this.$container=t,this.init())}init(){this.initTooltips(),this.initCopyButtons(),this.initLinkGenerator(),this.initSetReferrer(),this.initWithdrawModal(),this.initSettings(),this.setCookie()}initTooltips(){const t=r()("[data-tip]",this.$container);t.length&&t.each((function(){new O(r()(this))}))}initCopyButtons(){this.$container.find(".copy-trigger").each((function(){const t=r()(this),e=t.parent().find(".copy-target");e.length&&new x(t,e)}))}initLinkGenerator(){const t=r()(".link-generator",this.$container);t.length&&new F(t)}initSetReferrer(){const t=r()(".set-referrer-wrapper",this.$container);t.length&&new T(t)}initWithdrawModal(){const t=r()("#withdraw_modal_opener",this.$container);t.length&&!t.is(".disabled")&&new R(t)}initSettings(){const t=this.$container;t.length&&C(t)}setCookie(){yith_wcaf.set_cookie_via_ajax&&yith_wcaf.referral_var&&(()=>{if(!yith_wcaf.set_cookie_via_ajax||!yith_wcaf.referral_var)return;const t=new URLSearchParams(location.search);t.has(yith_wcaf.referral_var)&&S.get.call(null,"set_cookie","",{[yith_wcaf.referral_var]:t.get(yith_wcaf.referral_var)})})()}}r()((()=>{new E(r()(".yith-wcaf")),r()(document).on("yith_wcaf_shortcodes_init",(t=>{const e=r()(t.target);new E(e)}))}));var I=window;for(var j in e)I[j]=e[j];e.__esModule&&Object.defineProperty(I,"__esModule",{value:!0})})();